    function oyunuBaslat() {
        if(odadakiOyuncular.length < 3) return alert("En az 3 kişi!");
        
        let roller = ["Vampir", "Doktor"];
        while(roller.length < odadakiOyuncular.length) roller.push("Köylü");
        roller = roller.sort(() => Math.random() - 0.5);

        odadakiOyuncular.forEach((p, i) => {
            p.rol = roller[i];
            if(p.id === oyuncu.id) rolAta(p.rol);
        });

        // Önce tüm oyunculara bağlantı kur ve rolleri gönder
        const baglantiBekle = [];
        odadakiOyuncular.forEach(p => {
            if(p.id !== oyuncu.id) {
                const baglantiPromise = new Promise((resolve) => {
                    const c = peer.connect(p.id);
                    c.on('open', () => {
                        c.send({tip: "rol", rol: p.rol});
                        resolve();
                    });
                    // Timeout ekle
                    setTimeout(() => resolve(), 2000);
                });
                baglantiBekle.push(baglantiPromise);
            }
        });

        // ROL SALDIRISI: Herkes rolünü alana kadar saniyede 2 kez gönder!
        rolSaldiriInterval = setInterval(() => {
            let herkezAldiMi = true;
            odadakiOyuncular.forEach(p => {
                if(p.id !== oyuncu.id && !p.rolAldi) {
                    herkezAldiMi = false;
                    const c = peer.connect(p.id);
                    c.on('open', () => c.send({tip: "rol", rol: p.rol}));
                }
            });
            if(herkezAldiMi) {
                clearInterval(rolSaldiriInterval);
                geceDongusu();
            }
        }, 500);
        
        document.getElementById('startBtn').disabled = true;
        document.getElementById('startBtn').innerText = "ROLLER DAĞITILIYOR...";
    }
